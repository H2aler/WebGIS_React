<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>🧪 모든 기능 테스트</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background: #f5f5f5;
        }
        .container {
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .test-section {
            margin: 20px 0;
            padding: 15px;
            border: 1px solid #ddd;
            border-radius: 8px;
        }
        .test-section h3 {
            margin-top: 0;
            color: #333;
        }
        .test-btn {
            background: #28a745;
            color: white;
            border: none;
            padding: 10px 15px;
            margin: 5px;
            border-radius: 5px;
            cursor: pointer;
        }
        .test-btn:hover {
            background: #218838;
        }
        .test-btn.danger {
            background: #dc3545;
        }
        .test-btn.danger:hover {
            background: #c82333;
        }
        .status {
            margin-top: 10px;
            padding: 10px;
            border-radius: 5px;
            font-weight: bold;
        }
        .status.success {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }
        .status.error {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }
        .status.info {
            background: #d1ecf1;
            color: #0c5460;
            border: 1px solid #bee5eb;
        }
        .log {
            background: #f8f9fa;
            border: 1px solid #dee2e6;
            border-radius: 5px;
            padding: 15px;
            margin-top: 20px;
            font-family: monospace;
            font-size: 14px;
            max-height: 300px;
            overflow-y: auto;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>🧪 WebGIS 기능 테스트</h1>
        
        <div class="test-section">
            <h3>🔍 검색 기능 테스트</h3>
            <button class="test-btn" onclick="testSearch('서울')">서울 검색</button>
            <button class="test-btn" onclick="testSearch('부산')">부산 검색</button>
            <button class="test-btn" onclick="testSearch('도쿄')">도쿄 검색</button>
            <div id="searchStatus" class="status"></div>
        </div>

        <div class="test-section">
            <h3>📏 거리 측정 테스트</h3>
            <button class="test-btn" onclick="testDistanceMeasurement()">거리 측정 활성화</button>
            <button class="test-btn" onclick="testDistanceDeactivation()">거리 측정 비활성화</button>
            <div id="distanceStatus" class="status"></div>
        </div>

        <div class="test-section">
            <h3>📐 면적 측정 테스트</h3>
            <button class="test-btn" onclick="testAreaMeasurement()">면적 측정 활성화</button>
            <button class="test-btn" onclick="testAreaDeactivation()">면적 측정 비활성화</button>
            <div id="areaStatus" class="status"></div>
        </div>

        <div class="test-section">
            <h3>📍 마커 추가 테스트</h3>
            <button class="test-btn" onclick="testMarkerMode()">마커 모드 활성화</button>
            <button class="test-btn" onclick="testMarkerDeactivation()">마커 모드 비활성화</button>
            <div id="markerStatus" class="status"></div>
        </div>

        <div class="test-section">
            <h3>🗑️ 데이터 관리 테스트</h3>
            <button class="test-btn" onclick="testClearAll()">모든 데이터 삭제</button>
            <button class="test-btn" onclick="testExportData()">데이터 내보내기</button>
            <div id="dataStatus" class="status"></div>
        </div>

        <div class="test-section">
            <h3>🗺️ 지도 컨트롤 테스트</h3>
            <button class="test-btn" onclick="testZoomIn()">줌 인</button>
            <button class="test-btn" onclick="testZoomOut()">줌 아웃</button>
            <button class="test-btn" onclick="testFullExtent()">전체 영역</button>
            <button class="test-btn" onclick="testLayerSwitch()">레이어 전환</button>
            <div id="controlStatus" class="status"></div>
        </div>

        <div class="log" id="log"></div>
    </div>

    <script>
        function addLog(message) {
            const time = new Date().toLocaleTimeString();
            const log = document.getElementById('log');
            log.innerHTML += `[${time}] ${message}\n`;
            log.scrollTop = log.scrollHeight;
        }

        function updateStatus(elementId, message, type = 'info') {
            const element = document.getElementById(elementId);
            element.textContent = message;
            element.className = `status ${type}`;
        }

        // 검색 기능 테스트
        function testSearch(query) {
            addLog(`🔍 검색 테스트: ${query}`);
            updateStatus('searchStatus', `검색 중: ${query}`, 'info');
            
            // 실제 검색 API 호출
            fetch(`https://nominatim.openstreetmap.org/search?format=json&q=${encodeURIComponent(query)}&limit=1`)
                .then(response => response.json())
                .then(data => {
                    if (data.length > 0) {
                        updateStatus('searchStatus', `✅ 검색 성공: ${data[0].display_name}`, 'success');
                        addLog(`✅ 검색 결과: ${data[0].display_name}`);
                    } else {
                        updateStatus('searchStatus', `❌ 검색 결과 없음`, 'error');
                        addLog(`❌ 검색 결과 없음`);
                    }
                })
                .catch(error => {
                    updateStatus('searchStatus', `❌ 검색 실패: ${error.message}`, 'error');
                    addLog(`❌ 검색 오류: ${error.message}`);
                });
        }

        // 거리 측정 테스트
        function testDistanceMeasurement() {
            addLog('📏 거리 측정 활성화 테스트');
            updateStatus('distanceStatus', '거리 측정 모드 활성화됨', 'success');
            
            // 실제 WebGIS 맵이 있다면 활성화
            if (window.webgisMap) {
                window.webgisMap.activateTool('distance');
                addLog('✅ 거리 측정 도구가 활성화되었습니다');
            } else {
                addLog('⚠️ WebGIS 맵이 로드되지 않았습니다');
            }
        }

        function testDistanceDeactivation() {
            addLog('📏 거리 측정 비활성화 테스트');
            updateStatus('distanceStatus', '거리 측정 모드 비활성화됨', 'info');
            
            if (window.webgisMap) {
                window.webgisMap.deactivateCurrentTool();
                addLog('✅ 거리 측정 도구가 비활성화되었습니다');
            }
        }

        // 면적 측정 테스트
        function testAreaMeasurement() {
            addLog('📐 면적 측정 활성화 테스트');
            updateStatus('areaStatus', '면적 측정 모드 활성화됨', 'success');
            
            if (window.webgisMap) {
                window.webgisMap.activateTool('area');
                addLog('✅ 면적 측정 도구가 활성화되었습니다');
            } else {
                addLog('⚠️ WebGIS 맵이 로드되지 않았습니다');
            }
        }

        function testAreaDeactivation() {
            addLog('📐 면적 측정 비활성화 테스트');
            updateStatus('areaStatus', '면적 측정 모드 비활성화됨', 'info');
            
            if (window.webgisMap) {
                window.webgisMap.deactivateCurrentTool();
                addLog('✅ 면적 측정 도구가 비활성화되었습니다');
            }
        }

        // 마커 추가 테스트
        function testMarkerMode() {
            addLog('📍 마커 모드 활성화 테스트');
            updateStatus('markerStatus', '마커 추가 모드 활성화됨', 'success');
            
            if (window.webgisMap) {
                window.webgisMap.activateTool('marker');
                addLog('✅ 마커 추가 모드가 활성화되었습니다');
            } else {
                addLog('⚠️ WebGIS 맵이 로드되지 않았습니다');
            }
        }

        function testMarkerDeactivation() {
            addLog('📍 마커 모드 비활성화 테스트');
            updateStatus('markerStatus', '마커 추가 모드 비활성화됨', 'info');
            
            if (window.webgisMap) {
                window.webgisMap.deactivateCurrentTool();
                addLog('✅ 마커 추가 모드가 비활성화되었습니다');
            }
        }

        // 데이터 관리 테스트
        function testClearAll() {
            addLog('🗑️ 모든 데이터 삭제 테스트');
            updateStatus('dataStatus', '데이터 삭제 확인 중...', 'info');
            
            if (window.webgisMap) {
                window.webgisMap.clearAllFeatures();
                addLog('✅ 모든 데이터가 삭제되었습니다');
                updateStatus('dataStatus', '모든 데이터가 삭제되었습니다', 'success');
            } else {
                addLog('⚠️ WebGIS 맵이 로드되지 않았습니다');
                updateStatus('dataStatus', 'WebGIS 맵이 로드되지 않았습니다', 'error');
            }
        }

        function testExportData() {
            addLog('💾 데이터 내보내기 테스트');
            updateStatus('dataStatus', '데이터 내보내기 중...', 'info');
            
            if (window.webgisMap) {
                window.webgisMap.exportData();
                addLog('✅ 데이터 내보내기가 완료되었습니다');
                updateStatus('dataStatus', '데이터 내보내기가 완료되었습니다', 'success');
            } else {
                addLog('⚠️ WebGIS 맵이 로드되지 않았습니다');
                updateStatus('dataStatus', 'WebGIS 맵이 로드되지 않았습니다', 'error');
            }
        }

        // 지도 컨트롤 테스트
        function testZoomIn() {
            addLog('🔍 줌 인 테스트');
            updateStatus('controlStatus', '줌 인 실행됨', 'success');
            
            if (window.webgisMap && window.webgisMap.map) {
                const view = window.webgisMap.map.getView();
                const zoom = view.getZoom();
                view.animate({
                    zoom: zoom + 1,
                    duration: 250
                });
                addLog(`✅ 줌 레벨이 ${zoom}에서 ${zoom + 1}로 변경되었습니다`);
            } else {
                addLog('⚠️ WebGIS 맵이 로드되지 않았습니다');
            }
        }

        function testZoomOut() {
            addLog('🔍 줌 아웃 테스트');
            updateStatus('controlStatus', '줌 아웃 실행됨', 'success');
            
            if (window.webgisMap && window.webgisMap.map) {
                const view = window.webgisMap.map.getView();
                const zoom = view.getZoom();
                view.animate({
                    zoom: zoom - 1,
                    duration: 250
                });
                addLog(`✅ 줌 레벨이 ${zoom}에서 ${zoom - 1}로 변경되었습니다`);
            } else {
                addLog('⚠️ WebGIS 맵이 로드되지 않았습니다');
            }
        }

        function testFullExtent() {
            addLog('🏠 전체 영역 테스트');
            updateStatus('controlStatus', '전체 영역으로 이동됨', 'success');
            
            if (window.webgisMap && window.webgisMap.map) {
                window.webgisMap.map.getView().fit([127.0, 37.0, 128.5, 38.0], {
                    padding: [50, 50, 50, 50],
                    duration: 1000
                });
                addLog('✅ 지도가 전체 영역으로 이동되었습니다');
            } else {
                addLog('⚠️ WebGIS 맵이 로드되지 않았습니다');
            }
        }

        function testLayerSwitch() {
            addLog('🗺️ 레이어 전환 테스트');
            updateStatus('controlStatus', '레이어 전환됨', 'success');
            
            if (window.webgisMap) {
                window.webgisMap.switchLayer('satellite');
                addLog('✅ 위성 이미지 레이어로 전환되었습니다');
                
                setTimeout(() => {
                    window.webgisMap.switchLayer('osm');
                    addLog('✅ OpenStreetMap 레이어로 복원되었습니다');
                }, 2000);
            } else {
                addLog('⚠️ WebGIS 맵이 로드되지 않았습니다');
            }
        }

        // 페이지 로드 시 초기화
        window.addEventListener('load', () => {
            addLog('🚀 기능 테스트 페이지가 로드되었습니다');
            addLog('💡 메인 WebGIS 애플리케이션에서 이 페이지를 열어 테스트하세요');
            
            // WebGIS 맵 상태 확인
            setTimeout(() => {
                if (window.webgisMap) {
                    addLog('✅ WebGIS 맵이 감지되었습니다');
                } else {
                    addLog('⚠️ WebGIS 맵이 감지되지 않았습니다. 메인 페이지에서 열어주세요.');
                }
            }, 1000);
        });
    </script>
</body>
</html> 